<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Simulador FTTH - Sistema de Puertos</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="./css/styles.css">
</head>
<body>

  <!-- Panel lateral -->
  <aside id="sidebar" class="sidebar">
    <div class="sb-head">
      <h1>üåê Simulador FTTH - Sistema de Puertos</h1>
      <div class="subtitle">Control individual de conexiones por puerto</div>
    </div>

    <div class="sb-body">

      <!-- Configuraci√≥n base -->
      <div class="section-title">Configuraci√≥n Base</div>
      <div class="row2">
        <div>
          <label for="puertos">Puertos PON (OLT)</label>
          <input id="puertos" type="number" min="1" max="8" value="2"/>
        </div>
        <div>
          <label for="limitePON">L√≠mite ONTs por PON</label>
          <select id="limitePON">
            <option value="64">64</option>
            <option value="128" selected>128</option>
          </select>
        </div>
      </div>

      <div class="row2">
        <div>
          <label for="capNAP">Capacidad NAP</label>
          <select id="capNAP">
            <option value="4">4</option>
            <option value="8" selected>8</option>
            <option value="12">12</option>
            <option value="16">16</option>
          </select>
        </div>
        <div>
          <label for="txPower">Potencia TX OLT (dBm)</label>
          <input id="txPower" type="number" value="3" step="0.5"/>
        </div>
      </div>

      <div class="help">
        <b>üí° C√≥mo funciona:</b>
        <br>‚Ä¢ Cada splitter muestra sus puertos disponibles
        <br>‚Ä¢ üü¢ Verde = Puerto usado | üî¥ Rojo = Puerto disponible
        <br>‚Ä¢ Selecciona el puerto para conectar siguiente elemento
        <br>‚Ä¢ Tipos: 1:2, 1:4, 1:8, 1:16, 1:32, 1:64
      </div>

      <hr class="section-divider">

      <!-- Opciones de visualizaci√≥n -->
      <div style="margin-top:12px;padding:10px;background:#fef3c7;border:1px solid #f59e0b;border-radius:8px">
        <label style="display:flex;align-items:center;gap:6px;font-size:12px">
          <input type="checkbox" id="showPowerLabels" checked>
          <span>Mostrar etiquetas de potencia</span>
        </label>
        <label style="display:flex;align-items:center;gap:6px;font-size:12px">
          <input type="checkbox" id="showPortNumbers" checked>
          <span>Mostrar n√∫meros de puerto</span>
        </label>
        <label style="display:flex;align-items:center;gap:6px;font-size:12px">
          <input type="checkbox" id="showUnusedPorts" checked>
          <span>Mostrar puertos sin usar</span>
        </label>
        <label style="display:flex;align-items:center;gap:6px;font-size:12px">
          <input type="checkbox" id="enableDragging">
          <span><b>üñ±Ô∏è Modo edici√≥n: Arrastrar elementos</b></span>
        </label>
        <button id="resetPositions" class="btn-min" style="margin-top:8px;width:100%;background:#fef2f2;color:#991b1b;border-color:#fca5a5">üîÑ Resetear posiciones</button>
      </div>

      <hr class="section-divider">

      <!-- Configuraci√≥n por PON -->
      <div class="section-title">Configuraci√≥n por PON</div>
      <div class="pon-tabs" id="ponTabs"></div>
      <div id="ponContents"></div>

      <button class="btn" id="generate">‚ö° Generar Diagrama</button>

      <div id="warn" class="warn" style="display:none"></div>

      <!-- Resumen -->
      <div class="summary-box">
        <h4>üìä Resumen Total</h4>
        <div class="summary-grid" id="summaryGrid"></div>
      </div>

      <hr class="section-divider">

      <!-- Tabla de p√©rdidas -->
      <div class="section-title">P√©rdidas por Rama</div>
      <table id="lossTable">
        <thead>
          <tr>
            <th>PON</th>
            <th>Ruta</th>
            <th>Pot.(dBm)</th>
            <th>% Pot.</th>
            <th>Nivel</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <div class="row2" style="margin-top:14px">
        <button id="expSVG" class="btn-min" title="Exportar a SVG">üì• SVG</button>
        <button id="expPNG" class="btn-min" title="Exportar a PNG">üì• PNG</button>
      </div>
    </div>
  </aside>

  <!-- Canvas principal -->
  <main class="canvas">
    <button id="toggleFab" class="toggle-fab" title="Abrir/Cerrar configuraci√≥n">‚ò∞</button>
    <svg id="svg" viewBox="0 0 2000 1200" preserveAspectRatio="xMidYMid meet">
      <text x="50%" y="50%" text-anchor="middle" fill="#9ca3af" font-size="20">
        ‚ö° Genera el diagrama desde el panel lateral
      </text>
    </svg>
  </main>

  <script type="module" src="./js/main.js"></script>
</body>
</html>
